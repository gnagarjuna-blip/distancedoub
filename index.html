<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIET - Group Betting DS Master Pro</title>
    <style>
        :root { --bg: #f4f6f9; --dark: #2d3436; --accent: #0984e3; --win: #00b894; --loss: #d63031; --gold: #fdcb6e; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 950px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); }
        
        .config-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 15px; background: #dfe6e9; padding: 15px; border-radius: 8px; }
        .config-group { display: flex; flex-direction: column; }
        .config-group label { font-size: 11px; font-weight: bold; margin-bottom: 5px; color: #636e72; }
        .config-group select, .config-group input { padding: 8px; border-radius: 4px; border: 1px solid #b2bec3; font-weight: bold; }

        #trigger-banner { width: 100%; padding: 12px; border-radius: 6px; text-align: center; margin-bottom: 15px; font-weight: bold; display: none; background: var(--win); color: white; border: 2px solid #fff; }

        .stats-bar { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 15px; }
        .stat-card { background: var(--dark); color: white; padding: 10px; border-radius: 6px; text-align: center; }
        .stat-val { font-size: 16px; font-weight: bold; display: block; color: var(--gold); }
        .val-win { color: var(--win); } .val-loss { color: var(--loss); }

        .wheel-strip { display: flex; overflow-x: auto; gap: 4px; padding: 10px; background: #2d3436; border-radius: 8px; margin-bottom: 15px; }
        .slot { min-width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 11px; font-weight: bold; color: white; }
        .r { background: #d63031; } .b { background: #2d3436; border: 1px solid #636e72; } .g { background: #00b894; }
        .last-hit { outline: 3px solid var(--gold); outline-offset: 1px; }

        .num-grid { display: grid; grid-template-columns: repeat(13, 1fr); gap: 4px; margin-bottom: 20px; }
        .n-btn { padding: 12px 0; border: none; border-radius: 4px; color: white; font-weight: bold; cursor: pointer; }
        
        .main-layout { display: grid; grid-template-columns: 1.5fr 1fr; gap: 15px; }
        .card { padding: 15px; border-radius: 8px; border: 1px solid #dfe6e9; background: #fff; }
        .bet-unit-badge { display: inline-block; padding: 8px 12px; background: #f1f2f6; border: 1px solid #ced4da; border-radius: 6px; margin: 3px; font-size: 12px; font-weight: bold; color: #7f8c8d; }
        .active-bet { background: #e1f5fe; border: 2px solid var(--accent); color: var(--dark); }
        .inactive-bet { opacity: 0.5; text-decoration: line-through; }
    </style>
</head>
<body>

<div class="container">
    <div id="trigger-banner">ðŸ”„ CONCISE DISTANCE REPEATED: PATTERN RESTART</div>

    <div class="config-grid">
        <div class="config-group">
            <label>Bet Style</label>
            <select id="bet-style" onchange="updateUI()">
                <option value="ds">Double Streets</option>
                <option value="st">Streets</option>
                <option value="cn">Corners</option>
                <option value="dz">Dozens</option>
            </select>
        </div>
        <div class="config-group"><label>Unit Price</label><input type="number" id="base-unit" value="10"></div>
        <div class="config-group">
            <label>Incr. After Loss</label>
            <select id="loss-trigger"></select>
        </div>
        <div class="config-group">
            <label>Decr. After Win</label>
            <select id="win-recovery"></select>
        </div>
    </div>

    <div class="stats-bar">
        <div class="stat-card">Profit/Loss<span id="stat-profit" class="stat-val">0</span></div>
        <div class="stat-card">Multiplier<span id="stat-mult" class="stat-val">1x</span></div>
        <div class="stat-card">Total Bet<span id="stat-total-bet" class="stat-val">0</span></div>
        <div class="stat-card">Win Streak<span id="stat-win-streak" class="stat-val val-win">0</span></div>
        <div class="stat-card">Loss Streak<span id="stat-loss-streak" class="stat-val val-loss">0</span></div>
    </div>

    <div class="wheel-strip" id="wheelStrip"></div>
    <div class="num-grid" id="btns"><button class="n-btn g" style="grid-row: span 3;" onclick="press(0)">0</button></div>

    <div class="main-layout">
        <div class="card">
            <h4 style="margin:0 0 10px 0;">Next Play Analysis</h4>
            <div id="bet-display">Input numbers to generate prediction...</div>
        </div>
        <div class="card">
            <h4 style="margin:0 0 10px 0;">Distance Freq</h4>
            <div id="dist-history" style="font-size: 11px;"></div>
        </div>
    </div>
    
    <button onclick="resetSession()" style="width:100%; padding:10px; margin-top:15px; background:#b2bec3; color:white; border:none; border-radius:4px; cursor:pointer; font-weight:bold;">RESET SESSION</button>
</div>

<script>
    const wheel = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
    const reds = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];
    let spins = [], distanceMap = {}, currentGroups = [], currentNumbers = [], bankroll = 0, mult = 1, winStreak = 0, lossStreak = 0;

    const bg = document.getElementById('btns');
    for(let i=1; i<=36; i++){
        const b = document.createElement('button');
        b.className = `n-btn ${reds.includes(i) ? 'r' : 'b'}`;
        b.innerText = i; b.onclick = () => press(i);
        bg.appendChild(b);
    }

    const lt = document.getElementById('loss-trigger');
    for(let i=1; i<=36; i++) lt.add(new Option(i + " Loss", i));
    lt.value = 2;

    const wr = document.getElementById('win-recovery');
    for(let i=1; i<=5; i++) wr.add(new Option(i + " Unit", i));

    function press(n) {
        let unit = parseFloat(document.getElementById('base-unit').value);
        let lT = parseInt(document.getElementById('loss-trigger').value);
        let wR = parseInt(document.getElementById('win-recovery').value);
        let style = document.getElementById('bet-style').value;

        if (currentGroups.length > 0) {
            let betTotal = currentGroups.length * unit * mult;
            bankroll -= betTotal;
            
            if (currentNumbers.includes(n)) {
                let factor = (style === 'ds') ? 6 : (style === 'st' ? 12 : (style === 'cn' ? 9 : 3));
                bankroll += (unit * mult * factor);
                mult = Math.max(1, mult - wR);
                winStreak++;
                lossStreak = 0;
            } else {
                lossStreak++;
                winStreak = 0;
                if (lossStreak % lT === 0) mult++;
            }
        }
        spins.push(n);
        updateUI();
    }

    function updateUI() {
        document.getElementById('stat-profit').innerText = bankroll.toFixed(0);
        document.getElementById('stat-mult').innerText = mult + "x";
        document.getElementById('stat-win-streak').innerText = winStreak;
        document.getElementById('stat-loss-streak').innerText = lossStreak;

        const strip = document.getElementById('wheelStrip');
        strip.innerHTML = '';
        wheel.forEach(n => {
            const s = document.createElement('div');
            s.className = `slot ${n===0?'g':(reds.includes(n)?'r':'b')} ${n===spins[spins.length-1]?'last-hit':''}`;
            s.innerText = n; strip.appendChild(s);
        });

        if (spins.length < 2) return;

        const last = spins[spins.length-1];
        const prev = spins[spins.length-2];
        const dist = (wheel.indexOf(last) - wheel.indexOf(prev) + 37) % 37;
        distanceMap[dist] = (distanceMap[dist] || 0) + 1;

        document.getElementById('trigger-banner').style.display = (distanceMap[dist] > 1) ? 'block' : 'none';
        document.getElementById('dist-history').innerHTML = Object.entries(distanceMap)
            .sort((a,b) => b[1]-a[1]).map(([d,c]) => `<b>D${d}:</b> ${c}x`).join(' | ');

        processBets(last, dist);
    }

    function processBets(lastNum, dist) {
        const style = document.getElementById('bet-style').value;
        const targetIdx = (wheel.indexOf(lastNum) + dist) % 37;
        const wheelTargets = [wheel[(targetIdx - 1 + 37) % 37], wheel[targetIdx], wheel[(targetIdx + 1) % 37]];

        let activeGroupsSet = new Set();
        let allPossibleGroups = [];

        // Define all possible groups based on style
        if(style === 'ds') for(let i=0; i<6; i++) allPossibleGroups.push(`DS ${i*6+1}-${i*6+6}`);
        if(style === 'dz') for(let i=1; i<=3; i++) allPossibleGroups.push(`Dozen ${i}`);

        wheelTargets.forEach(num => {
            if (num === 0) { activeGroupsSet.add("Zero Area"); return; }
            if (style === 'ds') {
                const ds = Math.floor((num-1)/6);
                activeGroupsSet.add(`DS ${ds*6+1}-${ds*6+6}`);
            } else if (style === 'st') {
                const st = Math.floor((num-1)/3);
                activeGroupsSet.add(`ST ${st*3+1}-${st*3+3}`);
            } else if (style === 'cn') {
                const corner = num <= 2 ? 1 : (num >= 35 ? 32 : num);
                activeGroupsSet.add(`Corner ${corner}`);
            } else if (style === 'dz') {
                const dz = Math.ceil(num/12);
                activeGroupsSet.add(`Dozen ${dz}`);
            }
        });

        let activeGroupsArray = Array.from(activeGroupsSet);
        // Apply Caps
        const caps = { 'ds': 3, 'st': 5, 'cn': 4, 'dz': 2 };
        if (caps[style]) activeGroupsArray = activeGroupsArray.slice(0, caps[style]);

        currentGroups = activeGroupsArray;
        currentNumbers = [];
        
        // Map numbers for active groups
        currentGroups.forEach(g => {
            if(g === "Zero Area") { [0,1,2,3].forEach(z => currentNumbers.push(z)); return; }
            const val = parseInt(g.split(' ')[1]);
            if(style === 'ds') for(let i=0; i<6; i++) currentNumbers.push(val+i);
            if(style === 'st') for(let i=0; i<3; i++) currentNumbers.push(val+i);
            if(style === 'dz') for(let i=(val-1)*12+1; i<=val*12; i++) currentNumbers.push(i);
            if(style === 'cn') [val, val+1, val+3, val+4].forEach(c => {if(c<=36) currentNumbers.push(c)});
        });
        currentNumbers = [...new Set(currentNumbers)];

        document.getElementById('stat-total-bet').innerText = (currentGroups.length * mult * parseFloat(document.getElementById('base-unit').value));
        
        // Build Display
        let html = `<strong>Active:</strong><br>`;
        currentGroups.forEach(g => { html += `<span class="bet-unit-badge active-bet">${g}</span>`; });
        
        // Show Inactive for DS and Dozens
        if (style === 'ds' || style === 'dz') {
            html += `<br><br><strong>Inactive:</strong><br>`;
            allPossibleGroups.forEach(g => {
                if (!currentGroups.includes(g)) html += `<span class="bet-unit-badge inactive-bet">${g}</span>`;
            });
        }

        html += `<br><br><small>Numbers: ${currentNumbers.sort((a,b)=>a-b).join(', ')}</small>`;
        document.getElementById('bet-display').innerHTML = html;
    }

    function resetSession() {
        spins = []; distanceMap = {}; currentGroups = []; currentNumbers = []; bankroll = 0; mult = 1; winStreak = 0; lossStreak = 0;
        updateUI();
    }
</script>
</body>
</html>
