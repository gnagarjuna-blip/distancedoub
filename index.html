<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIET - DS Wheel Shift Dashboard</title>
    <style>
        :root { --bg: #f4f7f6; --card: #ffffff; --primary: #2c3e50; --accent: #16a085; --win: #27ae60; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 1000px; background: var(--card); padding: 20px; border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.1); }
        
        /* Wheel UI */
        .wheel-display { display: flex; overflow-x: auto; gap: 5px; padding: 15px; background: #1a1a1a; border-radius: 10px; margin-bottom: 20px; border-bottom: 4px solid var(--accent); }
        .slot { min-width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 13px; font-weight: bold; color: white; }
        .r { background: #e74c3c; } .b { background: #2c3e50; } .g { background: #27ae60; }
        .is-last { border: 3px solid #f1c40f; transform: scale(1.2); z-index: 10; }
        .is-target { border: 3px solid #3498db; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        /* Controls */
        .num-grid { display: grid; grid-template-columns: repeat(13, 1fr); gap: 6px; margin-bottom: 20px; }
        .n-btn { padding: 12px 0; border: none; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .n-btn:active { transform: scale(0.9); }

        /* Prediction Cards */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; }
        .card { padding: 20px; border-radius: 12px; border: 2px solid #eee; background: white; transition: 0.3s; }
        .winner { border-color: var(--win); background: #f0fff4; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.2); }
        .ds-row { margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; }
        .ds-box { background: #34495e; color: white; padding: 6px 12px; border-radius: 6px; font-weight: bold; font-size: 14px; }
        .ds-active { background: var(--win); border: 2px solid #fff; box-shadow: 0 0 5px var(--win); }
        
        .history { font-family: monospace; background: #2c3e50; color: #fff; padding: 12px; border-radius: 8px; margin-bottom: 15px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align: center; color: var(--primary);">ðŸŽ¯ Wheel Distance Mapper</h2>

    <div class="wheel-display" id="wheelStrip"></div>

    <div class="num-grid" id="inputGrid">
        <button class="n-btn g" style="grid-row: span 3;" onclick="input(0)">0</button>
    </div>

    <div class="history" id="hist">History: Waiting for 2 spins...</div>

    <div class="grid" id="output"></div>
</div>

<script>
    const wheel = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
    const reds = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];
    let spins = [];
    let activePreds = {};

    // Generate Buttons
    const ig = document.getElementById('inputGrid');
    for(let i=1; i<=36; i++) {
        const b = document.createElement('button');
        b.className = `n-btn ${reds.includes(i) ? 'r' : 'b'}`;
        b.innerText = i;
        b.onclick = () => input(i);
        ig.appendChild(b);
    }

    function getDS(n) { return Math.ceil(n / 6); }

    function drawWheel(targets = []) {
        const strip = document.getElementById('wheelStrip');
        strip.innerHTML = '';
        wheel.forEach((n, idx) => {
            const s = document.createElement('div');
            let c = n === 0 ? 'g' : (reds.includes(n) ? 'r' : 'b');
            if(spins.length > 0 && n === spins[spins.length-1]) c += ' is-last';
            if(targets.includes(n)) c += ' is-target';
            s.className = `slot ${c}`;
            s.innerText = n;
            strip.appendChild(s);
        });
    }

    function input(val) {
        const curDS = val === 0 ? 0 : getDS(val);
        let winKeys = [];
        
        // Check hits from last round
        for(let k in activePreds) {
            if(activePreds[k].includes(curDS)) winKeys.push(k);
        }

        spins.push(val);
        process(curDS, winKeys);
    }

    function process(curDS, winKeys) {
        document.getElementById('hist').innerText = "History: " + spins.slice(-12).join(" | ");
        const out = document.getElementById('output');
        out.innerHTML = '';
        
        if(spins.length < 2) { drawWheel(); return; }

        const last = spins[spins.length-1];
        const prev = spins[spins.length-2];
        const lastIdx = wheel.indexOf(last);
        const prevIdx = wheel.indexOf(prev);

        // 1. Calculate the raw distance (jump)
        const distCW = (lastIdx - prevIdx + 37) % 37;
        const distACW = (prevIdx - lastIdx + 37) % 37;

        // 2. Map distances to the wheel starting FROM THE LAST RESULT
        // Clockwise Target: Last index + CW distance
        const targetIdxCW = (lastIdx + distCW) % 37;
        const targetNumCW = wheel[targetIdxCW];
        
        // Anti-Clockwise Target: Last index - ACW distance
        const targetIdxACW = (lastIdx - distACW + 37) % 37;
        const targetNumACW = wheel[targetIdxACW];

        drawWheel([targetNumCW, targetNumACW]);

        const configs = [
            { name: "Clockwise Shift", dist: distCW, target: targetNumCW },
            { name: "Anti-Clock Shift", dist: distACW, target: targetNumACW }
        ];

        let newPreds = {};

        configs.forEach(conf => {
            const baseDS = conf.target === 0 ? 1 : getDS(conf.target);
            // Neighbor DS logic (e.g., if target is 33, DS is 6, we give 5 & 6)
            let prediction = [...new Set([baseDS, (baseDS % 6) + 1])].sort();
            
            newPreds[conf.name] = prediction;
            const isWin = winKeys.includes(conf.name);

            const card = document.createElement('div');
            card.className = `card ${isWin ? 'winner' : ''}`;
            card.innerHTML = `
                <div style="font-weight:bold; color:var(--primary)">${conf.name}</div>
                <div style="font-size:12px; color:#666; margin:5px 0;">
                    Jump: ${conf.dist} slots âž” Lands on: <b>${conf.target}</b>
                </div>
                <div class="ds-row">
                    ${prediction.map(ds => `
                        <div class="ds-box ${isWin && ds === curDS ? 'ds-active' : ''}">DS ${ds}</div>
                    `).join('')}
                </div>
            `;
            out.appendChild(card);
        });

        activePreds = newPreds;
    }

    drawWheel();
</script>
</body>
</html>
